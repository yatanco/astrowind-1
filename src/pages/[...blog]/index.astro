---
import { getCollection } from "astro:content";
import Layout from "~/layouts/PageLayout.astro";
import GridItem from "~/components/blog/GridItem.astro";

export const prerender = true;

// âœ… Fetch all posts
const posts = (await getCollection("post"))
  .filter((post) => !post.data.draft)
  .sort(
    (a, b) =>
      new Date(b.data.publishDate).getTime() -
      new Date(a.data.publishDate).getTime()
  );
---

<Layout metadata={{ title: "Blog", description: "Latest posts" }}>
  <section class="py-12 sm:py-16 lg:py-20 mx-auto max-w-6xl px-4 sm:px-6">
    <h1 class="text-4xl font-bold mb-8 text-center">Blog</h1>
    <div class="grid gap-6 row-gap-5 md:grid-cols-2 lg:grid-cols-3">
      {posts.map((post) => (
        <GridItem post={{ ...post.data, slug: post.slug }} />
      ))}
    </div>
  </section>
</Layout>
